(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{316:function(t,a,s){"use strict";s.r(a);var e=s(10),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"部分导入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部分导入"}},[t._v("#")]),t._v(" 部分导入")]),t._v(" "),a("h2",{attrs:{id:"引言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#引言"}},[t._v("#")]),t._v(" 引言")]),t._v(" "),a("p",[t._v("在快速上手部分，我们使用以下语句导入了依赖")]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" monaco "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monaco-editor'")]),t._v("\n")])])]),a("p",[t._v("但需注意的是："),a("strong",[t._v("此为全部导入")]),t._v("，即将 Monaco 中所有的功能及语言都导入并生成最终构建产物，因此当您的项目构建完成时，您会在静态资源中发现有很多的 js 文件，细细观察即可发现此为自带的语言，如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/statics_language.png",alt:"构建产物图"}})]),t._v(" "),a("p",[t._v("这对于一个简单、小型的 JavaScript 编辑器来说非常非常的重，因此我们有必要进行导入优化来排除那些我们不需要的依赖，做到最小化的构建一个项目")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("以下内容参考自 "),a("a",{attrs:{href:"https://juejin.cn/post/7133041161618325512#heading-0",target:"_blank",rel:"noopener noreferrer"}},[t._v("@GeorgeWhite"),a("OutboundLink")],1),t._v(" ，详情可前往进行查看；以下包含案例均以可以正常实现一个 JavaScript 编辑器为目标")])]),t._v(" "),a("h2",{attrs:{id:"使用-vite-打包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-vite-打包"}},[t._v("#")]),t._v(" 使用 Vite 打包")]),t._v(" "),a("p",[t._v("Vite 端虽然也有 "),a("a",{attrs:{href:"https://github.com/vdesjs/vite-plugin-monaco-editor",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite-plugin-monaco-editor"),a("OutboundLink")],1),t._v(" 插件，但是该插件并不像官方提供的 WebPack 插件一样可以通过配置指定需要开启的语言和特性，且该插件已有将近两年未更新，因此暂时放弃")]),t._v(" "),a("p",[t._v("Rollup 端虽然也有 "),a("a",{attrs:{href:"https://github.com/chengcyber/rollup-plugin-monaco-editor",target:"_blank",rel:"noopener noreferrer"}},[t._v("rollup-plugin-monaco-editor"),a("OutboundLink")],1),t._v(" 插件，同时该插件也可以同官方一样配置指定需要开启的语言和特性，但该插件仅支持 "),a("code",[t._v("monaco v0.34.0")]),t._v(" 及以下的版本，故放弃")]),t._v(" "),a("h3",{attrs:{id:"导入核心功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导入核心功能"}},[t._v("#")]),t._v(" 导入核心功能")]),t._v(" "),a("p",[t._v("在官方文档中 "),a("a",{attrs:{href:"https://github.com/microsoft/monaco-editor/tree/main/webpack-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-plugin"),a("OutboundLink")],1),t._v(" 处有提到如果只需要部分功能和语言的子集可以这样导入：")]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" monaco "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monaco-editor'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// or import * as monaco from 'monaco-editor/esm/vs/editor/editor.api';")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// if shipping only a subset of the features & languages is desired")]),t._v("\n")])])]),a("p",[t._v("使用以上第二行导入方式后我们可以发现编译后的产物不再包含语言文件，且当运行项目时发现语法高亮、输入关联提醒等功能失效，这是因为我们目前没有引入语言及功能特性导致的")]),t._v(" "),a("p",[t._v("首先我们需要了解 Monaco 中携带了哪些特性及语言，可以去 "),a("code",[t._v("node_modules\\monaco-editor\\esm\\metadata.js")]),t._v(" 路径下的该文件查看对应特性及语言，以下是个人理解对应字段代表的功能特性：")]),t._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("功能特性详情")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("label")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("accessibilityHelp")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}})])])])]),t._v(" "),a("h3",{attrs:{id:"导入所需语言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导入所需语言"}},[t._v("#")]),t._v(" 导入所需语言")]),t._v(" "),a("p",[a("code",[t._v("metadata.js")]),t._v(" 文件中包含了语言的 entry 文件，因此如果想要导入指定的语言的话只要按该路径导入即可，如下：")]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monaco-editor/esm/vs/basic-languages/javascript/javascript.contribution'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ts")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monaco-editor/esm/vs/basic-languages/typescript/typescript.contribution'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monaco-editor/esm/vs/language/typescript/monaco.contribution'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("导入之后发现语法高亮可以正常使用了，但是没有输入提示，因此需要导入特定的功能特性")]),t._v(" "),a("h3",{attrs:{id:"导入功能特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导入功能特性"}},[t._v("#")]),t._v(" 导入功能特性")]),t._v(" "),a("p",[a("code",[t._v("metadata.js")]),t._v(" 文件中包含了特性的 entry 文件，因此按自己所需导入指定的功能特性即可，如下：")]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 引入代码折叠特性")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monaco-editor/esm/vs/editor/contrib/folding/browser/folding'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"使用-webpack-打包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-webpack-打包"}},[t._v("#")]),t._v(" 使用 Webpack 打包")]),t._v(" "),a("p",[t._v("使用 Webpack 打包工具时，官方提供了专门的插件来简化以上步骤，可以前往 "),a("a",{attrs:{href:"https://github.com/microsoft/monaco-editor/tree/main/webpack-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("Monaco Editor Webpack Loader Plugin"),a("OutboundLink")],1),t._v(" 进行查看，仅需要在插件配置中指定你所需要引入的语言和功能特性即可")])])}),[],!1,null,null,null);a.default=r.exports}}]);